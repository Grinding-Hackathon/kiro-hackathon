# API Reference Documentation\n\n## üéØ Overview\n\nThe Offline Blockchain Wallet API provides RESTful endpoints for wallet management, token operations, and blockchain integration. All endpoints use JSON for request/response data and require proper authentication.\n\n**Base URL**: `https://api.wallet.com/api/v1`\n\n## üîê Authentication\n\n### JWT Token Authentication\n\nAll protected endpoints require a valid JWT token in the Authorization header:\n\n```http\nAuthorization: Bearer <jwt-token>\n```\n\n### Token Lifecycle\n\n1. **Login**: Obtain access and refresh tokens\n2. **Access**: Use access token for API calls\n3. **Refresh**: Use refresh token to get new access token\n4. **Logout**: Invalidate tokens\n\n## üìö Endpoints\n\n### Authentication\n\n#### POST /auth/register\n\nRegister a new user account.\n\n**Request:**\n```json\n{\n  \"username\": \"john_doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"confirmPassword\": \"SecurePass123!\"\n}\n```\n\n**Response (201):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"username\": \"john_doe\",\n      \"email\": \"john@example.com\",\n      \"walletAddress\": \"0x742d35Cc6634C0532925a3b8D404d3aAB451e9c\",\n      \"createdAt\": \"2024-01-15T10:30:00Z\"\n    },\n    \"tokens\": {\n      \"accessToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n      \"refreshToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n      \"expiresIn\": \"24h\"\n    }\n  }\n}\n```\n\n#### POST /auth/login\n\nAuthenticate user and receive tokens.\n\n**Request:**\n```json\n{\n  \"email\": \"john@example.com\",\n  \"password\": \"SecurePass123!\"\n}\n```\n\n**Response (200):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"username\": \"john_doe\",\n      \"email\": \"john@example.com\",\n      \"walletAddress\": \"0x742d35Cc6634C0532925a3b8D404d3aAB451e9c\"\n    },\n    \"tokens\": {\n      \"accessToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n      \"refreshToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n      \"expiresIn\": \"24h\"\n    }\n  }\n}\n```\n\n### Wallet Management\n\n#### GET /wallet/balance\n\nGet current wallet balance.\n\n**Headers:**\n```http\nAuthorization: Bearer <access-token>\n```\n\n**Response (200):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"walletAddress\": \"0x742d35Cc6634C0532925a3b8D404d3aAB451e9c\",\n    \"balances\": {\n      \"blockchain\": {\n        \"amount\": 1250.75,\n        \"currency\": \"ETH\",\n        \"lastUpdated\": \"2024-01-15T10:30:00Z\"\n      },\n      \"offline\": {\n        \"amount\": 125.50,\n        \"tokenCount\": 5,\n        \"lastUpdated\": \"2024-01-15T09:45:00Z\"\n      },\n      \"pending\": {\n        \"amount\": 25.00,\n        \"transactionCount\": 2\n      }\n    },\n    \"totalBalance\": 1401.25\n  }\n}\n```\n\n#### POST /wallet/purchase\n\nPurchase tokens for offline use.\n\n**Headers:**\n```http\nAuthorization: Bearer <access-token>\n```\n\n**Request:**\n```json\n{\n  \"amount\": 100.00,\n  \"paymentMethod\": \"ethereum\",\n  \"transactionHash\": \"0x1234567890abcdef...\",\n  \"gasPrice\": \"20000000000\",\n  \"gasLimit\": \"21000\"\n}\n```\n\n**Response (201):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"transactionId\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"tokens\": [\n      {\n        \"id\": \"token-uuid-1\",\n        \"amount\": 25.00,\n        \"signature\": \"0x3045022100...\",\n        \"expiresAt\": \"2024-02-15T10:30:00Z\",\n        \"createdAt\": \"2024-01-15T10:30:00Z\"\n      }\n    ],\n    \"totalAmount\": 100.00,\n    \"blockchainTransaction\": {\n      \"hash\": \"0x1234567890abcdef...\",\n      \"blockNumber\": 18500000,\n      \"gasUsed\": \"21000\",\n      \"status\": \"confirmed\"\n    }\n  }\n}\n```\n\n### Token Operations\n\n#### POST /tokens/validate\n\nValidate an offline token.\n\n**Headers:**\n```http\nAuthorization: Bearer <access-token>\n```\n\n**Request:**\n```json\n{\n  \"tokenId\": \"token-uuid-1\",\n  \"signature\": \"0x3045022100...\",\n  \"amount\": 25.00\n}\n```\n\n**Response (200):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"valid\": true,\n    \"token\": {\n      \"id\": \"token-uuid-1\",\n      \"amount\": 25.00,\n      \"ownerId\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"signature\": \"0x3045022100...\",\n      \"isSpent\": false,\n      \"expiresAt\": \"2024-02-15T10:30:00Z\",\n      \"createdAt\": \"2024-01-15T10:30:00Z\"\n    },\n    \"validationDetails\": {\n      \"signatureValid\": true,\n      \"notExpired\": true,\n      \"notSpent\": true,\n      \"ownershipValid\": true\n    }\n  }\n}\n```\n\n#### POST /tokens/divide\n\nDivide a token for making change.\n\n**Headers:**\n```http\nAuthorization: Bearer <access-token>\n```\n\n**Request:**\n```json\n{\n  \"tokenId\": \"token-uuid-1\",\n  \"paymentAmount\": 15.00,\n  \"signature\": \"0x3045022100...\"\n}\n```\n\n**Response (200):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"originalToken\": {\n      \"id\": \"token-uuid-1\",\n      \"amount\": 25.00,\n      \"status\": \"divided\"\n    },\n    \"paymentToken\": {\n      \"id\": \"payment-token-uuid\",\n      \"amount\": 15.00,\n      \"signature\": \"0x3045022100...\",\n      \"expiresAt\": \"2024-02-15T10:30:00Z\",\n      \"createdAt\": \"2024-01-15T11:00:00Z\"\n    },\n    \"changeToken\": {\n      \"id\": \"change-token-uuid\",\n      \"amount\": 10.00,\n      \"signature\": \"0x3045022100...\",\n      \"expiresAt\": \"2024-02-15T10:30:00Z\",\n      \"createdAt\": \"2024-01-15T11:00:00Z\"\n    }\n  }\n}\n```\n\n## üîí Security\n\n### Rate Limiting\n\n- **Default**: 100 requests per 15 minutes per IP\n- **Authentication**: 5 requests per 15 minutes per IP\n- **Token operations**: 50 requests per 15 minutes per user\n\n### Error Responses\n\n```json\n{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"VALIDATION_ERROR\",\n    \"message\": \"Invalid input data\",\n    \"details\": {\n      \"field\": \"amount\",\n      \"reason\": \"Amount must be positive\"\n    },\n    \"timestamp\": \"2024-01-15T10:30:00Z\",\n    \"requestId\": \"req-uuid-here\"\n  }\n}\n```\n\n### Common Error Codes\n\n- `AUTHENTICATION_REQUIRED`: Missing or invalid authentication\n- `AUTHORIZATION_FAILED`: Insufficient permissions\n- `VALIDATION_ERROR`: Invalid input data\n- `RESOURCE_NOT_FOUND`: Requested resource doesn't exist\n- `RATE_LIMIT_EXCEEDED`: Too many requests\n- `BLOCKCHAIN_ERROR`: Blockchain operation failed\n- `INSUFFICIENT_BALANCE`: Not enough funds\n- `TOKEN_EXPIRED`: Token has expired\n- `TOKEN_ALREADY_SPENT`: Token has already been used\n- `INTERNAL_SERVER_ERROR`: Unexpected server error\n\n---\n\n*For complete API documentation, visit `/api-docs` when the server is running.*\n"